<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memes Gallery</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Welcome to the Memes Gallery</h1>
        <div class="media-gallery" id="media-gallery">
        </div>
    </div>

    <div id="lightbox" class="lightbox">
        <span id="close-lightbox" class="close-lightbox">&times;</span>
        <div class="lightbox-content">
            <video id="lightbox-video" class="lightbox-video" controls></video>
            <img id="lightbox-image" class="lightbox-image" />
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        fetch('files.json')
            .then(response => response.json())
            .then(data => {
                const gallery = document.getElementById('media-gallery');
                data.forEach(item => {
                    const mediaItem = document.createElement('div');
                    mediaItem.classList.add('media-item');
                    
                    const mediaLink = document.createElement('a');
                    mediaLink.href = item.url;
                    mediaLink.classList.add('media-link');
                    
                    const extension = item.url.split('.').pop().toLowerCase();
                    let mediaElement;

                    if (['mp4', 'webm', 'mov'].includes(extension)) {
                        mediaElement = document.createElement('video');
                        mediaElement.setAttribute('controls', '');
                        const source = document.createElement('source');
                        source.src = item.url;
                        source.type = `video/${extension}`;
                        mediaElement.appendChild(source);
                    } else {
                        mediaElement = document.createElement('img');
                        mediaElement.src = item.url;
                        mediaElement.alt = item.name;
                    }

                    mediaLink.appendChild(mediaElement);
                    mediaItem.appendChild(mediaLink);

                    const copyButton = document.createElement('button');
                    copyButton.classList.add('copy-link-btn');
                    copyButton.setAttribute('data-link', item.url);
                    copyButton.textContent = 'Copy Link';
                    mediaItem.appendChild(copyButton);

                    gallery.appendChild(mediaItem);
                });

                document.querySelectorAll('.media-link').forEach(link => {
                    link.addEventListener('click', function(event) {
                        event.preventDefault();
                        const mediaSource = this.getAttribute('href');
                        const mediaExtension = mediaSource.split('.').pop().toLowerCase();
                        const lightbox = document.getElementById('lightbox');
                        const lightboxVideo = document.getElementById('lightbox-video');
                        const lightboxImage = document.getElementById('lightbox-image');

                        if (['mp4', 'webm', 'mov'].includes(mediaExtension)) {
                            lightboxVideo.src = mediaSource;
                            lightboxVideo.style.display = 'block';
                            lightboxImage.style.display = 'none';
                        } else {
                            lightboxImage.src = mediaSource;
                            lightboxImage.style.display = 'block';
                            lightboxVideo.style.display = 'none';
                        }

                        lightbox.style.display = 'flex';
                    });
                });

                document.getElementById('close-lightbox').addEventListener('click', function() {
                    const lightbox = document.getElementById('lightbox');
                    lightbox.style.display = 'none';
                    const lightboxVideo = document.getElementById('lightbox-video');
                    const lightboxImage = document.getElementById('lightbox-image');
                    lightboxVideo.pause();
                    lightboxVideo.currentTime = 0;
                    lightboxImage.src = '';
                });

                document.querySelectorAll('.copy-link-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const link = this.getAttribute('data-link');
                        navigator.clipboard.writeText(link)
                            .then(() => {
                                alert('Link copied to clipboard!');
                            })
                            .catch(err => {
                                alert('Failed to copy link!');
                            });
                    });
                });
            })
            .catch(error => console.error('Error loading files.json:', error));
    </script>
</body>
</html>
